<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" >
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="JWT 개발 적용기" />
<meta property="og:locale" content="en" />
<meta name="description" content="JWT를 적용하게 된 배경 기존에 개발했던 솔루션은 온프레미스 서버에 구축되는 솔루션이었기에 JWT와 같은 구현이 따로 필요하지 않았다. Spring Security를 이용해 세션으로 사용자 인증을 진행하였으며, 다중화된 서버는 L4장비에서 Hash 방식등을 이용하거나 톰캣 세션 클러스터링을 구현하였기 때문에 문제가 되지 않았다. 그러나 클라우드 서버에 구축할 SaaS 서비스를 새로 개발하게 되면서 AutoScaling을 구현하려니 Stateless한 인증은 필수가 되었다." />
<meta property="og:description" content="JWT를 적용하게 된 배경 기존에 개발했던 솔루션은 온프레미스 서버에 구축되는 솔루션이었기에 JWT와 같은 구현이 따로 필요하지 않았다. Spring Security를 이용해 세션으로 사용자 인증을 진행하였으며, 다중화된 서버는 L4장비에서 Hash 방식등을 이용하거나 톰캣 세션 클러스터링을 구현하였기 때문에 문제가 되지 않았다. 그러나 클라우드 서버에 구축할 SaaS 서비스를 새로 개발하게 되면서 AutoScaling을 구현하려니 Stateless한 인증은 필수가 되었다." />
<link rel="canonical" href="http://localhost:4000/posts/JWT-%EA%B0%9C%EB%B0%9C-%EC%A0%81%EC%9A%A9%EA%B8%B0/" />
<meta property="og:url" content="http://localhost:4000/posts/JWT-%EA%B0%9C%EB%B0%9C-%EC%A0%81%EC%9A%A9%EA%B8%B0/" />
<meta property="og:site_name" content="Chirpy" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-01-25T10:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="JWT 개발 적용기" />
<meta name="twitter:site" content="@twitter_username" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-01-25T10:00:00+08:00","datePublished":"2024-01-25T10:00:00+08:00","description":"JWT를 적용하게 된 배경 기존에 개발했던 솔루션은 온프레미스 서버에 구축되는 솔루션이었기에 JWT와 같은 구현이 따로 필요하지 않았다. Spring Security를 이용해 세션으로 사용자 인증을 진행하였으며, 다중화된 서버는 L4장비에서 Hash 방식등을 이용하거나 톰캣 세션 클러스터링을 구현하였기 때문에 문제가 되지 않았다. 그러나 클라우드 서버에 구축할 SaaS 서비스를 새로 개발하게 되면서 AutoScaling을 구현하려니 Stateless한 인증은 필수가 되었다.","headline":"JWT 개발 적용기","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/JWT-%EA%B0%9C%EB%B0%9C-%EC%A0%81%EC%9A%A9%EA%B8%B0/"},"url":"http://localhost:4000/posts/JWT-%EA%B0%9C%EB%B0%9C-%EC%A0%81%EC%9A%A9%EA%B8%B0/"}</script>
<!-- End Jekyll SEO tag -->


  <title>JWT 개발 적용기 | Chirpy
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Chirpy">
<meta name="application-name" content="Chirpy">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- Scripts -->

  <script src="/assets/js/dist/theme.min.js"></script>

  <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js"></script>







<script defer src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  



  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="https://chirpy-img.netlify.app/commons/avatar.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">Chirpy</a>
    <p class="site-subtitle fst-italic mb-0">A text-focused Jekyll theme</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      

      
        <a
          href="https://github.com/github_username"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://twitter.com/twitter_username"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fa-brands fa-x-twitter"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['example','domain.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>JWT 개발 적용기</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link" aria-label="Search">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  

  
  

  

  
  

  

  
  

  




<!-- return -->










<article class="px-1" data-toc="false">
  <header>
    <h1 data-toc-skip>JWT 개발 적용기</h1>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1706148000"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Jan 25, 2024
</time>

      </span>

      <!-- lastmod date -->
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://twitter.com/username">your_full_name</a>
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="1861 words"
>
  <em>10 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  

  <div class="content">
    <h1 id="jwt를-적용하게-된-배경">JWT를 적용하게 된 배경</h1>
<p>기존에 개발했던 솔루션은 온프레미스 서버에 구축되는 솔루션이었기에 JWT와 같은 구현이 따로 필요하지 않았다.<br />
Spring Security를 이용해 세션으로 사용자 인증을 진행하였으며, 다중화된 서버는 L4장비에서 Hash 방식등을 이용하거나<br />
톰캣 세션 클러스터링을 구현하였기 때문에 문제가 되지 않았다.<br />
<br />
그러나 클라우드 서버에 구축할 SaaS 서비스를 새로 개발하게 되면서 <strong>AutoScaling을 구현하려니 Stateless한 인증은 필수</strong>가 되었다.<br />
<br />
<br /></p>

<h1 id="최초-구축한-jwt">최초 구축한 JWT</h1>
<p>현재는 JWT를 이용하면 security를 이용할 필요 없이 Filter로 구현하면 된다는 글이 자주 보이는 듯 하지만,<br />
내가 서치할 당시에는 <strong>JWT + Security</strong> 의 글이 가장 많이 보였다.<br />
인가 처리 때문에 security를 사용하면 편하다는 것 같았으나 내가 개발하는 페이지는 메뉴 권한을 테넌트별로 커스텀이 가능했기 때문에<br />
인가처리를 직접 해줘야해서 의미없어 보였다.<br />
그래서 <strong>JWTFilter</strong>를 만들어 <strong>JWT를 검증</strong>하고 <strong>메뉴 접근 권한을 확인</strong>하도록  하였다.<br />
<br />
<br /></p>

<h1 id="refresh-token에-대한-반감">Refresh Token에 대한 반감</h1>
<p>JWT를 공부해보니 세션과 달리 사용자 요청에 대한 <strong>슬라이딩 세션</strong> 기능을 구현하려면<br />
Filter에서 <strong>매 요청마다 JWT</strong>를 30분 뒤 만료로 <strong>새로 쿠키에 저장</strong>해줘야 하는 것 같았다.<br />
로그인을 하려면 2차 인증까지 해야 하는데 30분 지나면 다시 2차 인증을 거치는 게 좀 이상하게 느껴졌다.<br />
(내가 사용하는 구글 로그인은 2주씩은 로그인이 유지되는 것 같은데..)<br />
<br />
그러나 적용을 안하기엔 또 AccessToken의 만료를 길게 잡아두고 발급했는데 <strong>탈취 당하면 손쓸 수 없는 게</strong> 걸렸다.<br />
<br />
그래서 <strong>Refresh Token</strong> 이 존재했는데 이것도 이상했다.<br />
결국 Refresh Token을 이용하려면 <strong>DB를 이용</strong>해야했다.<br />
<br />
우선 플로우는 아래와 같다.<br />
<br />
<strong>로그인 요청 시</strong></p>
<ol>
  <li>사용자 로그인 정보 확인 후 <strong>로그인 성공 시 AccessToken, RefreshToken 발급</strong> <br />이때 <strong>AccessToken</strong>에는 로그인 인증/인가에 <strong>필요한 모든 정보</strong>를 담고, <strong>RefreshToken에는 email만</strong> 담는다.</li>
  <li>AcceseToken과 RefreshToken을 모두 클라이언트 <strong>cookie에 저장</strong>한다.</li>
  <li>RefreshToken은 <strong>DB에 저장</strong>한다. (Redis에 담았는데 <strong>Key: email / value: RefreshToken</strong>이 된다.)</li>
</ol>

<p><br />
<br />
로그인 후(JWT를 쿠키에 저장된 상태에서) 플로우는 아래와 같다.<br />
<a href="https://sykimtropical.github.io/blog/img/jwt-request-flow-diagram.png" class="popup img-link  shimmer"><img src="https://sykimtropical.github.io/blog/img/jwt-request-flow-diagram.png" alt="JWT 요청 후 응답 플로우" loading="lazy"></a></p>

<p><br /></p>

<ol>
  <li>사용자가 권한이 필요한 페이지를 요청하면 JWTFilter에서 <strong>RefreshToken을 우선 검증</strong>한다.<br />이때 만료여부를 검증하고 디코딩하여 <strong>email을 가져올 수 있다</strong>.<br />요청한 RefreshToken이 디코딩하여 나온 email 키로 <strong>저장된 DB의 refreshToken</strong>과 다르다면 검증에 실패한다.(이것으로 <strong>1계정 1세션</strong>또한 구현되었다.)</li>
  <li>검증에 성공하면 <strong>AccessToken을 검증</strong>한다.<br />이때 만약 만료되었다면 RefreshToken에서 가져온 email을 이용하여 <strong>자동으로 재로그인</strong> 과정을 거쳐 AccessToken을 <strong>재발급</strong>하여 <strong>cookie에 덮어씌워</strong>준다.</li>
</ol>

<p><br />
위와같은 플로우에서 이제 RefreshToken은 DB를 이용하기 때문에 탈취당했을 경우<br />
DB에서 해당 사용자의 RefreshToken을 지워준다면 <strong>원격으로 로그아웃이 가능</strong>해진다.<br />
<br />
그러나 Filter를 거치는 <strong>매 요청마다 DB를 연결</strong> 해야하기 때문에 이상하다고 느꼈으며 비효율적이라는 생각이 들었다.<br />
<br />
결론적으로는 1계정 1세션을 구현해야하기 때문에 RefreshToken은 내 불만은 뒤로하고 구현할 수 밖에 없었다.<br />
잦고 많은 DB연결이 고민되어 어차피 사용하게 될 <strong>Redis DB</strong>를 이용하였더니 속도도 빠르고 보안도 해결 된 것 같아 마음이 좀 놓였다.<br />
<br />
<br /></p>

<h1 id="cookie-max-size-로-인한-jwt-저장-오류">Cookie Max Size 로 인한 JWT 저장 오류</h1>
<p>위에서 언급했다시피 사용자마다 접근 가능한 메뉴의 권한이 커스텀 가능했기 때문에<br />
로그인 한 사용자가 접근 가능한 메뉴를 사용자 세션에 저장해야했다.<br />
<br />
아무생각없이 AccessToken payload 내에 menuAuth배열로 접근가능한 url을 패턴화 하여 전부 담았다.<br />
토큰이 좀 길어진 것 같은데 뭐 어떻냐 하고 로그인을 시도했다.<br />
<br />
로그인에 실패했다.<br />
쿠키가 자꾸 없어진다.<br />
<br />
알고보니 도메인마다 저장할 수 있는 <strong>모든 쿠키</strong>의 max size가 있었다.<br />
쿠키값이 여러개여도 총합의 max size였다.<br />
<br />
<br /></p>
<blockquote>
  <p>구글 bard 답변<br />
	쿠키의 최대 크기는 브라우저마다 다를 수 있지만, 일반적으로 4096바이트이라는 제한이 있습니다.<br />
	즉, 쿠키 하나에 저장할 수 있는 데이터의 양은 4096바이트를 넘을 수 없다는 의미죠.<br />
	<br />하지만 이는 쿠키의 값만을 의미합니다.<br />
	쿠키 자체는 실제 데이터 외에도 이름, 도메인, 경로, 만료 시간 등 추가 정보를 포함하기 때문에 실제 사용 가능한 공간은 약간 줄어듭니다.<br />
	대략 4000바이트 정도를 사용할 수 있다고 생각하면 됩니다.<br />
	<br />또한, 브라우저마다 쿠키 저장 개수에도 제한이 있습니다.<br />
	대부분의 브라우저는 사이트 당 20개까지 쿠키를 저장할 수 있으며,<br />
	전체적으로는 사용자 당 3000개 정도까지 저장할 수 있습니다.<br /></p>
</blockquote>

<p><br />
<br />
결국 url을 담지 못하고 menu id(pk) 만 담았으며, menu id와 매핑되는 url들은<br />
어플리케이션 부팅 시 메모리에 담아 <code class="language-plaintext highlighter-rouge">map</code>에서 찾아올 수 있도록 처리하였다.<br />
<br />
<br /></p>

<h1 id="jwt-저장-위치에-대한-고민">JWT 저장 위치에 대한 고민</h1>
<p>JWT를 저장할 수 있는 브라우저 위치는 cookie와 localstorage 두군데이다.<br />
브라우저에 저장 한다는거 자체가 보안적인 취약점이 존재하는 것 같았다.<br />
<br />
하지만 로컬 스토리지는 XSS 공격으로부터 방어할 수 있는 방법이 없는 것 같았고,<br />
쿠키는 CSRF 공경에 취약하지만 Http Only, Secure 옵션을 이용하면 방어할 수 있는 듯 하였다.<br />
<br />
그렇기에 cookie 에 저장하기로 했으며 httponly, secure 옵션을 아래와 같이 설정하여 처리하였다.<br /></p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="n">cookie</span> <span class="o">=</span> <span class="nc">ResponseCookie</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">cookieName</span><span class="o">,</span> <span class="n">cookieValue</span><span class="o">)</span>
    <span class="o">.</span><span class="na">httpOnly</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="c1">// 스크립트 공격 방어</span>
    <span class="o">.</span><span class="na">sameSite</span><span class="o">(</span><span class="s">"Strict"</span><span class="o">)</span>   <span class="c1">// 가장 보수적인 정책으로 크로르 사이트 요청에는 전송되지 않도록 처리</span>
    <span class="o">.</span><span class="na">secure</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>       <span class="c1">// 네트워크를 통한 탈취 방어</span>
    <span class="o">.</span><span class="na">path</span><span class="o">(</span><span class="s">"/"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">build</span><span class="o">();</span>
</pre></td></tr></tbody></table></code></div></div>

<p><br />
<br />
위 설정으로 인해 Set-Cookie 값 맨 뒤 HttpOnly가 붙은 걸 확인 할 수 있다.<br />
Set-Cookie: AccessToken=Bearer+{토큰값}; path=/; <strong>HttpOnly</strong></p>


  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/jwt/"
            class="post-tag no-text-decoration"
          >JWT</a>
        
          <a
            href="/tags/accesstoken/"
            class="post-tag no-text-decoration"
          >AccessToken</a>
        
          <a
            href="/tags/refreshtoken/"
            class="post-tag no-text-decoration"
          >RefreshToken</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=JWT%20%EA%B0%9C%EB%B0%9C%20%EC%A0%81%EC%9A%A9%EA%B8%B0%20-%20Chirpy&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FJWT-%25EA%25B0%259C%25EB%25B0%259C-%25EC%25A0%2581%25EC%259A%25A9%25EA%25B8%25B0%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=JWT%20%EA%B0%9C%EB%B0%9C%20%EC%A0%81%EC%9A%A9%EA%B8%B0%20-%20Chirpy&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FJWT-%25EA%25B0%259C%25EB%25B0%259C-%25EC%25A0%2581%25EC%259A%25A9%25EA%25B8%25B0%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FJWT-%25EA%25B0%259C%25EB%25B0%259C-%25EC%25A0%2581%25EC%259A%25A9%25EA%25B8%25B0%2F&text=JWT%20%EA%B0%9C%EB%B0%9C%20%EC%A0%81%EC%9A%A9%EA%B8%B0%20-%20Chirpy" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Generic-(Feat.-Object,-Enum)/">Generic (Feat. Object, Enum)</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/%EC%8A%A4%ED%8A%B8%EB%A6%BC(Stream)%EA%B3%BC-%EC%98%B5%EC%85%94%EB%84%90(Optional)/">스트림(Stream)과 옵셔널(Optional)</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/%EB%9E%8C%EB%8B%A4-(Lamda)/">람다식(Lamda)</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/DB-%EB%B3%84-varchar(n)-%EC%9D%98-n-%EC%9D%98%EB%AF%B8/">DB별 varchar(n)의 n 의미</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Spring-Boot3-&-Undertow-%EC%97%90%EC%84%9C-HTTP-Method-%EC%A0%9C%ED%95%9C%ED%95%98%EA%B8%B0/">Spring Boot3 & Undertow 에서 HTTP Method 제한하기</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/java/">java</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/jwt/">JWT</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/accesstoken/">AccessToken</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/actuator/">actuator</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/aop/">AOP</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/boot/">boot</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/coldstart/">coldstart</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/customannotaion/">customannotaion</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/db/">DB</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/enum/">Enum</a>
      
    </div>
  </section>


            </div>

            
              
              







            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  
    










  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/JWT-%EA%B8%B0%EB%B3%B8/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1706061600"
  data-df="ll"
  
>
  Jan 24, 2024
</time>

              <h4 class="pt-0 my-2">JWT 기본</h4>
              <div class="text-muted">
                <p>기존 Session 처리방식  이전에 JWT를 사용하지 않았다면 사용자의 로그인 정보는 Session을 이용하여 처리했을 것이다.  Spring Security를 통해 로그인 된 사용자의 정보를 가져온다던지, session.getAttribute(&quot;로그인한 유저 정보&quot;);  를 가져온다면 session을 이용하는 것이다.  세션을 이용한다면  로그인 ...</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/JWT-%EA%B8%B0%EB%B3%B8/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>JWT 기본</p>
    </a>
  

  
    <a
      href="/posts/boot%EA%B0%80-%EC%95%84%EC%A7%81-%EC%A4%80%EB%B9%84%EB%90%98%EC%A7%80-%EC%95%8A%EC%95%98%EB%8A%94%EB%8D%B0-%EA%B8%B0%EC%A1%B4-%ED%8C%8C%EB%93%9C%EA%B0%80-%EC%82%AD%EC%A0%9C%EB%90%A0%EB%95%8C/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>boot가 아직 준비되지 않았는데 기존 파드가 삭제될때</p>
    </a>
  
</nav>

            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2025</time>

    
      <a href="https://twitter.com/username">your_full_name</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.2.4"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/java/">java</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/jwt/">JWT</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/accesstoken/">AccessToken</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/actuator/">actuator</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/aop/">AOP</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/boot/">boot</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/coldstart/">coldstart</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/customannotaion/">customannotaion</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/db/">DB</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/enum/">Enum</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- Embedded scripts -->

    
      
      <!-- The comments switcher -->


    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  
  document.addEventListener('DOMContentLoaded', () => {
    SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('search-results'),
      json: '/assets/js/data/search.json',
      searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{content}</p>  </article>',
      noResultsText: '<p class="mt-5">Oops! No results found.</p>',
      templateMiddleware: function(prop, value, template) {
        if (prop === 'categories') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
          }
        }

        if (prop === 'tags') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
          }
        }
      }
    });
  });
</script>

  </body>
</html>

